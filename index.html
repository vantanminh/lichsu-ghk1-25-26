<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√în Luy·ªán L·ªãch S·ª≠ - N√¢ng cao</title>
    
    <!-- Google Fonts: Be Vietnam Pro -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #4f46e5; /* Indigo */
            --primary-light: #e0e7ff;
            --secondary-color: #64748b;
            --success-color: #10b981; /* Emerald */
            --success-bg: #d1fae5;
            --error-color: #ef4444; /* Red */
            --error-bg: #fee2e2;
            --background-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --card-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background: var(--background-gradient);
            color: #1e293b;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* Header Styles */
        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            color: #1e293b;
            font-weight: 800;
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 0px rgba(255,255,255,0.5);
        }

        /* Controls Panel */
        .controls-card {
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            position: sticky;
            top: 10px;
            z-index: 100;
            border: 1px solid rgba(255,255,255,0.5);
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
        }

        /* Mode Switcher Styling */
        .mode-selector {
            display: flex;
            background: #f1f5f9;
            padding: 5px;
            border-radius: 12px;
        }

        .mode-selector label {
            cursor: pointer;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            color: var(--secondary-color);
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            user-select: none;
        }

        .mode-selector input[type="radio"] {
            display: none;
        }

        .mode-selector label:has(input:checked) {
            background: white;
            color: var(--primary-color);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .reset-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .reset-btn:hover {
            background-color: #4338ca;
            transform: translateY(-2px);
        }

        .reset-btn:active {
            transform: translateY(0);
        }

        /* Section Titles */
        .section-title {
            font-size: 1.25rem;
            color: var(--primary-color);
            border-left: 5px solid var(--primary-color);
            padding-left: 15px;
            margin: 40px 0 20px 0;
            font-weight: 700;
            background: linear-gradient(90deg, rgba(79, 70, 229, 0.1) 0%, rgba(255, 255, 255, 0) 100%);
            padding-top: 10px;
            padding-bottom: 10px;
            border-radius: 0 8px 8px 0;
        }

        /* Question Cards */
        .question-block {
            background: white;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--card-shadow);
            border: 1px solid #e2e8f0;
            transition: transform 0.2s ease;
        }
        
        .question-header {
            margin-bottom: 20px;
            font-size: 1.1rem;
            font-weight: 600;
            color: #334155;
        }

        .q-number {
            color: var(--primary-color);
            font-weight: 800;
            margin-right: 8px;
        }

        /* Image Styling */
        .question-image {
            display: block;
            max-width: 100%;
            max-height: 400px;
            height: auto;
            margin: 15px auto 25px auto;
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
        }

        /* Options Grid */
        .options {
            display: grid;
            gap: 12px;
        }

        .options label {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            background: #fff;
            position: relative;
            overflow: hidden;
        }

        .options label:hover {
            border-color: var(--primary-color);
            background-color: #f8fafc;
        }

        .options input[type="radio"] {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #cbd5e1;
            border-radius: 50%;
            margin-right: 15px;
            flex-shrink: 0;
            position: relative;
            transition: var(--transition);
        }

        .options input[type="radio"]:checked {
            border-color: var(--primary-color);
            background-color: var(--primary-color);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .option-prefix {
            font-weight: 700;
            margin-right: 8px;
            color: var(--secondary-color);
        }

        /* True/False Specifics */
        .tf-options .options-wrapper {
            background: #f8fafc;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
            border: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
        }

        .tf-statement {
            margin-bottom: 10px;
            font-weight: 500;
        }

        .tf-choices {
            display: flex;
            gap: 15px;
        }

        .tf-choices label {
            flex: 1;
            text-align: center;
            padding: 8px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .tf-choices input {
            display: none; 
        }

        .tf-choices label:has(input:checked) {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Feedback Styles */
        .options label.immediate-correct,
        .options label.final-correct,
        .show-correct-answer {
            background-color: var(--success-bg) !important;
            border-color: var(--success-color) !important;
            color: #065f46;
        }

        .options label.immediate-incorrect,
        .options label.final-incorrect,
        .tf-choices label.final-incorrect {
            background-color: var(--error-bg) !important;
            border-color: var(--error-color) !important;
            color: #991b1b;
        }
        
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }
        
        .immediate-incorrect {
            animation: shake 0.4s ease-in-out;
        }

        /* Explanation Box */
        .explanation-box {
            background-color: #f1f5f9;
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            margin-top: 15px;
            border-radius: 0 8px 8px 0;
            font-size: 0.95rem;
            color: #334155;
            display: none; /* Hidden by default */
            animation: slideUp 0.3s ease-out;
        }
        .explanation-box.show {
            display: block;
        }
        .explanation-title {
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
            display: block;
        }

        /* Submit Button */
        .submit-btn {
            display: block;
            width: 100%;
            max-width: 400px;
            margin: 40px auto;
            padding: 18px;
            font-size: 1.2rem;
            font-weight: 700;
            color: #fff;
            background: linear-gradient(135deg, var(--primary-color) 0%, #4338ca 100%);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 20px -5px rgba(79, 70, 229, 0.4);
            transition: var(--transition);
        }

        .submit-btn:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 15px 25px -5px rgba(79, 70, 229, 0.5);
        }

        /* Results Box */
        #results {
            margin-top: 40px;
            padding: 30px;
            border-radius: 20px;
            background: white;
            border: 2px solid var(--primary-color);
            text-align: center;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            animation: slideUp 0.5s ease-out;
        }

        #results h2 {
            color: var(--primary-color);
            margin-top: 0;
            font-size: 1.8rem;
        }

        #total-score {
            font-size: 2rem;
            color: #1e293b;
            margin: 20px 0;
        }

        .score-detail {
            font-size: 1.1rem;
            color: var(--secondary-color);
            margin: 5px 0;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .hidden { display: none !important; }

        /* Media Queries */
        @media (max-width: 600px) {
            .controls-card {
                flex-direction: column;
                align-items: stretch;
            }
            .mode-selector {
                width: 100%;
                justify-content: center;
            }
            .reset-btn {
                width: 100%;
                justify-content: center;
            }
            .question-block {
                padding: 15px;
            }
            h1 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>√în Luy·ªán L·ªãch S·ª≠</h1>
            <p style="color: #64748b; font-weight: 500;">H·ªá th·ªëng c√¢u h·ªèi tr·∫Øc nghi·ªám & n√¢ng cao</p>
        </header>
        
        <div class="controls-card">
            <div class="mode-selector">
                <label>
                    <input type="radio" name="mode" value="practice" checked> 
                    <span>üìö Luy·ªán t·∫≠p</span>
                </label>
                <label>
                    <input type="radio" name="mode" value="test"> 
                    <span>‚è±Ô∏è Thi th·ª≠</span>
                </label>
            </div>
            <button type="button" class="reset-btn">
                <span>üîÑ</span> Tr·ªôn ƒë·ªÅ & L√†m l·∫°i
            </button>
        </div>

        <form id="quizForm">
            <div id="part1-container">
                <div class="section-title">PH·∫¶N I. TR·∫ÆC NGHI·ªÜM NHI·ªÄU L·ª∞A CH·ªåN</div>
                <div id="mc-questions-container">
                    <!-- JS Injects here -->
                </div>
            </div>

            <div id="part2-container">
                <div class="section-title">PH·∫¶N II. TR·∫ÆC NGHI·ªÜM ƒê√öNG ‚Äì SAI</div>
                <div id="tf-questions-container">
                    <!-- JS Injects here -->
                </div>
            </div>
            
            <button type="submit" class="submit-btn hidden">N·ªòP B√ÄI THI</button>
        </form>

        <div id="results" class="hidden">
            <h2>üèÜ K·∫øt Qu·∫£ B√†i Thi</h2>
            <div id="total-score" style="font-weight: 800;"></div>
            <p id="score-mc" class="score-detail"></p>
            <p id="score-tf" class="score-detail hidden"></p>
            <button type="button" class="reset-btn" style="margin: 20px auto;" onclick="document.querySelector('.reset-btn').click()">L√†m l·∫°i b√†i</button>
        </div>
    </div>

    <script>
    const quizData = {
        mc: [
            { q: "S·ª± ph√°t tri·ªÉn c·ªßa n·ªÅn kinh t·∫ø ƒë√£ l√†m bi·∫øn ƒë·ªïi x√£ h·ªôi T√¢y √Çu v√† B·∫Øc M·ªπ, xu·∫•t hi·ªán c√°c giai c·∫•p, t·∫ßng l·ªõp m·ªõi ƒë·∫°i di·ªán cho ph∆∞∆°ng th·ª©c s·∫£n xu·∫•t", a: "A", o: { A: "t∆∞ b·∫£n ch·ªß nghƒ©a.", B: "phong ki·∫øn.", C: "x√£ h·ªôi ch·ªß nghƒ©a.", D: "chi·∫øm h·ªØu n√¥ l·ªá." } },
            { q: "ƒê·∫øn gi·ªØa th·∫ø k·ªâ XVIII, mi·ªÅn B·∫Øc c·ªßa 13 bang thu·ªôc ƒë·ªãa Anh ·ªü B·∫Øc Mƒ© ph·ªï bi·∫øn ph√°t tri·ªÉn", a: "B", o: { A: "kinh t·∫ø ƒë·ªìn ƒëi·ªÅn.", B: "c√¥ng tr∆∞·ªùng th·ªß c√¥ng.", C: "d·ªát v√† l√†m g·ªëm.", D: "ph∆∞·ªùng h·ªôi th·ªß c√¥ng." } },
            { q: "L·ª±c l∆∞·ª£ng n√†o l√£nh ƒë·∫°o c·ªßa cu·ªôc c√°ch m·∫°ng t∆∞ s·∫£n th·∫ø k·ªâ XVI - XVIII?", a: "A", o: { A: "Giai c·∫•p t∆∞ s·∫£n.", B: "Giai c·∫•p c√¥ng nh√¢n.", C: "Giai c·∫•p n√¥ng d√¢n.", D: "Giai c·∫•p ƒë·ªãa ch·ªß." } },
            { q: "C√°c cu·ªôc c√°ch m·∫°ng t∆∞ s·∫£n th·∫ø k·ªâ XVI - XVIII c√≥ hai nhi·ªám v·ª• c∆° b·∫£n l√†", a: "A", o: { A: "d√¢n t·ªôc v√† d√¢n ch·ªß.", B: "d√¢n t·ªôc v√† d√¢n sinh.", C: "ƒë·ªôc l·∫≠p v√† t·ª± do.", D: "d√¢n ch·ªß v√† d√¢n quy·ªÅn." } },
            { q: "ƒê·∫≥ng c·∫•p 3 trong x√£ h·ªôi Ph√°p tr∆∞·ªõc c√°ch m·∫°ng t∆∞ s·∫£n (th·∫ø k·ªâ XVIII) g·ªìm nh·ªØng l·ª±c l∆∞·ª£ng n√†o?", a: "A", o: { A: "T∆∞ s·∫£n, n√¥ng d√¢n, b√¨nh d√¢n th√†nh th·ªã.", B: "Qu√Ω t·ªôc, n√¥ng d√¢n, tƒÉng l·ªØ, th·ª£ th·ªß c√¥ng.", C: "TƒÉng l·ªØ, qu√Ω t·ªôc v√† t∆∞ s·∫£n, n√¥ng d√¢n.", D: "Vua, quan l·∫°i, tƒÉng l·ªØ, b√¨nh d√¢n th√†nh th·ªã." } },
            { q: "ƒê·∫∑c ƒëi·ªÉm n·ªïi b·∫≠t c·ªßa t√¨nh h√¨nh ch√≠nh tr·ªã n∆∞·ªõc Anh v√† Ph√°p tr∆∞·ªõc khi b√πng n·ªï c√°ch m·∫°ng t∆∞ s·∫£n l√†", a: "A", o: { A: "t·ªìn t·∫°i ch·∫ø ƒë·ªô qu√¢n ch·ªß chuy√™n ch·∫ø.", B: "l√† thu·ªôc ƒë·ªãa c·ªßa ch·ªß nghƒ©a th·ª±c d√¢n.", C: "xu·∫•t hi·ªán kinh t·∫ø t∆∞ b·∫£n ch·ªß nghƒ©a.", D: "xu·∫•t hi·ªán tr√†o l∆∞u tri·∫øt h·ªçc √°nh s√°ng." } },
            { q: "C√°c cu·ªôc c√°ch m·∫°ng t∆∞ s·∫£n th·ªùi c·∫≠n ƒë·∫°i c√≥ ƒëi·ªÉm g√¨ chung?", a: "A", o: { A: "M·ªü ƒë∆∞·ªùng cho ch·ªß nghƒ©a t∆∞ b·∫£n ph√°t tri·ªÉn.", B: "T∆∞ s·∫£n v√† ch·ªß n√¥ l√£nh ƒë·∫°o.", C: "Nh·∫±m m·ª•c ƒë√≠ch x√≥a b·ªè ch·∫ø ƒë·ªô n√¥ l·ªá.", D: "Di·ªÖn ra d∆∞·ªõi h√¨nh th·ª©c n·ªôi chi·∫øn." } },
            { q: "T√≠nh ch·∫•t c·ªßa Chi·∫øn tranh gi√†nh ƒë·ªôc l·∫≠p ·ªü B·∫Øc Mƒ© cu·ªëi th·∫ø k·ªâ XVIII l√† cu·ªôc", a: "C", o: { A: "n·ªôi chi·∫øn ƒë·∫´m m√°u.", B: "c√°ch m·∫°ng t∆∞ s·∫£n tri·ªát ƒë·ªÉ.", C: "c√°ch m·∫°ng t∆∞ s·∫£n kh√¥ng tri·ªát ƒë·ªÉ.", D: "chi·∫øn tranh gi·∫£i ph√≥ng v√¥ s·∫£n." } },
            { q: "M·ª•c ti√™u chung c·ªßa c√°ch cu·ªôc c√°ch m·∫°ng t∆∞ s·∫£n ·ªü th·∫ø k·ªâ XVI- XVIII l√† g√¨?", a: "A", o: { A: "L·∫≠t ƒë·ªï ch·∫ø ƒë·ªï phong ki·∫øn, th·ª±c d√¢n c√πng t√†n t√≠ch c·ªßa n√≥.", B: "L·∫≠t ƒë·ªï x√£ h·ªôi nguy√™n th·ªßy, c·ªï ƒë·∫°i c√πng t√†n t√≠ch c·ªßa n√≥.", C: "T·∫°o ƒëi·ªÅu ki·ªán cho s·ª± ph√°t tri·ªÉn c·ªßa ch·∫ø ƒë·ªô phong ki·∫øn.", D: "M·ªü ƒë∆∞·ªùng cho s·ª± ph√°t tri·ªÉn c·ªßa ch·ªß nghƒ©a x√£ h·ªôi." } },
            { q: "M√¢u thu·∫´n n√†o sau ƒë√¢y l√† m·ªôt trong nh·ªØng ti·ªÅn ƒë·ªÅ c·ªßa c√°c c√°ch m·∫°ng t∆∞ s·∫£n?", a: "C", o: { A: "C√¥ng nh√¢n v·ªõi ƒë·ªãa ch·ªß phong ki·∫øn.", B: "T∆∞ s·∫£n v·ªõi t·∫ßng l·ªõp qu√Ω t·ªôc m·ªõi.", C: "T∆∞ s·∫£n, qu√Ω t·ªôc m·ªõi v·ªõi ch·∫ø ƒë·ªô phong ki·∫øn.", D: "B√¨nh d√¢n th√†nh th·ªã v·ªõi nh√† n∆∞·ªõc phong ki·∫øn." } },
            { q: "H√¨nh b√™n m√¥ t·∫£ bi·ªÉu hi·ªán n√†o sau ƒë√¢y khi quan h·ªá s·∫£n xu·∫•t t∆∞ b·∫£n ch·ªß nghƒ©a ƒë√£ x√¢m nh·∫≠p v√†o n√¥ng nghi·ªáp ·ªü n∆∞·ªõc Anh cu·ªëi th·∫ø k·ªâ XV ƒë·∫ßu th·∫ø k·ªâ XVI?", a: "A", o: { A: "Hi·ªán t∆∞·ª£ng ‚ÄúC·ª´u ƒÉn th·ªãt ng∆∞·ªùi‚Äù.", B: "Ng√†nh c√¥ng nghi·ªáp ph√°t tri·ªÉn.", C: "Ng√†nh d·ªát len d·∫° ph√°t tri·ªÉn.", D: "C√¥ng tr∆∞·ªùng th·ªß c√¥ng ra ƒë·ªùi." } },
            
            // C√¢u 12 c√≥ h√¨nh ·∫£nh
            { q: "S·ª± ki·ªán n√†o ·ªü h√¨nh b√™n ƒë√°nh d·∫•u C√°ch m·∫°ng t∆∞ s·∫£n Ph√°p b√πng n·ªï (14/7/1789)?", a: "B", img: "https://vantanminh.github.io/lichsu-ghk1-25-26/data/1.png", o: { A: "Qu·ªëc h·ªôi ph·∫ø tru·∫•t vua, thi·∫øt l·∫≠p n·ªÅn c·ªông h√≤a.", B: "Qu·∫ßn ch√∫ng nh√¢n d√¢n t·∫•n c√¥ng ng·ª•c Bastilles.", C: "Qu√¢n kh·ªüi nghƒ©a t·∫•n c√¥ng cung ƒëi·ªán Versailles.", D: "H·ªôi ngh·ªã ba ƒë·∫≥ng c·∫•p t·∫°i cung ƒëi·ªán Versailles." } },
            
            { q: "ƒê·∫°i h·ªôi X√¥ vi·∫øt to√†n Nga l·∫ßn th·ª© hai, khai m·∫°c ƒë√™m 25-10-1917 ƒë√£ ra tuy√™n b·ªë", a: "A", o: { A: "th√†nh l·∫≠p ch√≠nh quy·ªÅn X√¥ vi·∫øt.", B: "th√¥ng qua s·∫Øc l·ªánh ‚ÄúH√≤a b√¨nh‚Äù.", C: "th√¥ng qua s·∫Øc l·ªánh ‚ÄúRu·ªông ƒë·∫•t‚Äù.", D: "th√¥ng qua ch√≠nh s√°ch ‚ÄúKinh t·∫ø m·ªõi‚Äù." } },
            { q: "B·ªën n∆∞·ªõc ƒë·∫ßu ti√™n trong Li√™n bang c·ªông h√≤a x√£ h·ªôi ch·ªß nghƒ©a X√¥ vi·∫øt (1922) l√†", a: "A", o: { A: "Nga, U-crai-na, B√™-l√¥-r√∫t-xi-a v√† Ngo·∫°i C√°p-ca-d∆°.", B: "Nga, B√™-l√¥-r√∫t-xi-a, Ca-d·∫Øc-xtan v√† Ngo·∫°i C√°p-ca-d∆°.", C: "Nga, U-crai-na, E-xt√¥-ni-a v√† L√≠t-va.", D: "Nga, U-crai-na, L√≠t-va, B√™-la-r√∫t-xi-a." } },
            { q: "S·ª± ra ƒë·ªùi c·ªßa Li√™n bang C·ªông ho√† x√£ h·ªôi ch·ªß nghƒ©a X√¥ vi·∫øt c√≥ √Ω nghƒ©a nh∆∞ th·∫ø n√†o ƒë·ªëi v·ªõi qu·ªëc t·∫ø?", a: "B", o: { A: "L√†m th·∫•t b·∫°i √Ω ƒë·ªì v√† h√†nh ƒë·ªông chia r·∫Ω c·ªßa c√°c th·∫ø l·ª±c th√π ƒë·ªãch.", B: "T·∫°o ti·ªÅn ƒë·ªÅ cho s·ª± ra ƒë·ªùi c·ªßa h·ªá th·ªëng x√£ h·ªôi ch·ªß nghƒ©a.", C: "C·ªßng c·ªë v√† tƒÉng c∆∞·ªùng v·ªã th·∫ø c·ªßa Li√™n X√¥ tr√™n tr∆∞·ªùng qu·ªëc t·∫ø.", D: "T·∫°o ƒëi·ªÅu ki·ªán ƒë·ªÉ c√°c n∆∞·ªõc c·ªông h√≤a ph√°t tri·ªÉn kinh t·∫ø - x√£ h·ªôi." } },
            { q: "Nh·∫±m th·ªß ti√™u nh·ªØng t√†n t√≠ch c·ªßa ch·∫ø ƒë·ªô phong ki·∫øn, ƒëem l·∫°i c√°c quy·ªÅn t·ª± do, d√¢n ch·ªß cho nh√¢n d√¢n, ng√†y 26/10/1917 (theo l·ªãch Nga), Ch√≠nh quy·ªÅn Nga X√¥ vi·∫øt ƒë√£", a: "C", o: { A: "th√¥ng qua Ch√≠nh s√°ch kinh t·∫ø m·ªõi do Lenin so·∫°n th·∫£o.", B: "ph√°t ƒë·ªông cu·ªôc ƒë·∫•u tranh ch·ªëng th√π trong, gi·∫∑c ngo√†i.", C: "ban h√†nh S·∫Øc l·ªánh H√≤a b√¨nh v√† S·∫Øc l·ªánh Ru·ªông ƒë·∫•t.", D: "ban h√†nh Ch√≠nh s√°ch C·ªông s·∫£n th·ªùi chi·∫øn." } },
            { q: "Nguy√™n nh√¢n quy·∫øt ƒë·ªãnh d·∫´n ƒë·∫øn th·∫Øng l·ª£i c·ªßa c√°c n∆∞·ªõc C·ªông h√≤a x√£ h·ªôi ch·ªß nghƒ©a tr√™n ƒë·∫•t n∆∞·ªõc X√¥ vi·∫øt trong cu·ªôc chi·∫øn ch·ªëng th√π trong, gi·∫∑c ngo√†i l√†", a: "A", o: { A: "s·ª± ƒëo√†n k·∫øt, gi√∫p ƒë·ª° nhau.", B: "s·ª± ·ªßng h·ªô t·ª´ b√™n ngo√†i.", C: "c√≥ s·ª©c m·∫°nh v·ªÅ ngo·∫°i giao.", D: "c√≥ s·ª± ·ªßng h·ªô c·ªßa M·ªπ." } },
            { q: "Sau C√°ch m·∫°ng th√°ng M∆∞·ªùi Nga (1917), nhi·ªám v·ª• h√†ng ƒë·∫ßu c·ªßa ch√≠nh quy·ªÅn X√¥ vi·∫øt l√†", a: "A", o: { A: "ƒë·∫≠p tan b·ªô m√°y nh√† n∆∞·ªõc c≈©, x√¢y d·ª±ng b·ªô m√°y nh√† n∆∞·ªõc m·ªõi.", B: "h√†n g·∫Øn v·∫øt th∆∞∆°ng chi·∫øn tranh, kh√¥i ph·ª•c v√† ph√°t tri·ªÉn kinh t·∫ø.", C: "kh√¥i ph·ª•c v√† ph√°t tri·ªÉn kinh t·∫ø, ch·ªëng l·∫°i th√π trong gi·∫∑c ngo√†i.", D: "ti·∫øn h√†nh c√¥ng nghi·ªáp h√≥a, hi·ªán ƒë·∫°i h√≥a ti·∫øn l√™n ch·ªß nghƒ©a x√£ h·ªôi." } },
            { q: "ƒê·ªëi v·ªõi Li√™n X√¥, s·ª± ra ƒë·ªùi c·ªßa Li√™n bang C·ªông ho√† x√£ h·ªôi ch·ªß nghƒ©a X√¥ vi·∫øt <strong>kh√¥ng</strong> c√≥ √Ω nghƒ©a n√†o sau ƒë√¢y?", a: "D", o: { A: "Th·ªÉ hi·ªán s·ª©c m·∫°nh ƒëo√†n k·∫øt, gi√∫p ƒë·ª° nhau gi·ªØa c√°c d√¢n t·ªôc X√¥ vi·∫øt.", B: "Ph√π h·ª£p v·ªõi l·ª£i √≠ch chung c·ªßa c√°c d√¢n t·ªôc tr√™n ƒë·∫•t n∆∞·ªõc X√¥ vi·∫øt.", C: "TƒÉng c∆∞·ªùng v·ªã th·∫ø c·ªßa Nh√† n∆∞·ªõc Li√™n X√¥ tr√™n tr∆∞·ªùng qu·ªëc t·∫ø.", D: "T·∫°o ti·ªÅn ƒë·ªÅ cho s·ª± ra ƒë·ªùi c·ªßa h·ªá th·ªëng x√£ h·ªôi ch·ªß nghƒ©a tr√™n th·∫ø gi·ªõi." } },
            { q: "Th√°ng 01/1924, b·∫£n Hi·∫øn ph√°p ƒë·∫ßu ti√™n c·ªßa Li√™n X√¥ ƒë∆∞·ª£c th√¥ng qua, ho√†n th√†nh qu√° tr√¨nh th√†nh l·∫≠p", a: "D", o: { A: "nh√† n∆∞·ªõc d√¢n ch·ªß t∆∞ s·∫£n ki·ªÉu m·ªõi ƒë·∫ßu ti√™n tr√™n th·∫ø gi·ªõi.", B: "ch√≠nh ƒê·∫£ng v√¥ s·∫£n ƒë·∫ßu ti√™n, ƒë·∫•u tranh cho quy·ªÅn l·ª£i c·ªßa m·ªçi giai c·∫•p.", C: "nh√† n∆∞·ªõc t∆∞ b·∫£n hi·ªán ƒë·∫°i ƒë·∫ßu ti√™n tr√™n th·∫ø gi·ªõi.", D: "nh√† n∆∞·ªõc Li√™n bang C·ªông ho√† x√£ h·ªôi ch·ªß nghƒ©a ƒë·∫ßu ti√™n tr√™n th·∫ø gi·ªõi." } },
            { q: "Hi·∫øn ph√°p Li√™n X√¥ (1924) ghi nh·∫≠n vi·ªác h·ª£p t√°c gi·ªØa c√°c n∆∞·ªõc X√¥ vi·∫øt th√†nh m·ªôt nh√† n∆∞·ªõc Li√™n bang d·ª±a tr√™n c∆° s·ªü", a: "C", o: { A: "ƒë·ªìng thu·∫≠n v·ªÅ vƒÉn h√≥a.", B: "h·ª£p nh·∫•t c√°c l·ª±c l∆∞·ª£ng.", C: "t·ª± nguy·ªán c·ªßa c√°c qu·ªëc gia.", D: "t·ª± nguy·ªán c√≥ ƒëi·ªÅu ki·ªán." } },
            { q: "Li√™n X√¥ ƒë∆∞·ª£c xem l√† ch·ªó d·ª±a v·ªØng ch·∫Øc c·ªßa phong tr√†o c√°ch m·∫°ng v√† h√≤a b√¨nh th·∫ø gi·ªõi v√¨", a: "A,B", explanation: "<strong>C·∫£ hai ƒë√°p √°n ƒë·ªÅu ph·∫£n √°nh ƒë√∫ng vai tr√≤ c·ªßa Li√™n X√¥:</strong><br>- <strong>V·ªÅ ch√≠nh s√°ch ƒë·ªëi ngo·∫°i:</strong> Li√™n X√¥ t√≠ch c·ª±c ·ªßng h·ªô phong tr√†o gi·∫£i ph√≥ng d√¢n t·ªôc, l√† ch·ªó d·ª±a tr·ª±c ti·∫øp cho phong tr√†o c√°ch m·∫°ng.<br>- <strong>V·ªÅ s·ª©c m·∫°nh qu√¢n s·ª±:</strong> Vi·ªác ƒë·∫°t th·∫ø c√¢n b·∫±ng chi·∫øn l∆∞·ª£c v·ªõi Mƒ© gi√∫p Li√™n X√¥ tr·ªü th√†nh ƒë·ªëi tr·ªçng v·ªØng ch·∫Øc, ngƒÉn ch·∫∑n chi·∫øn tranh v√† b·∫£o v·ªá h√≤a b√¨nh th·∫ø gi·ªõi.<br>T√πy v√†o g√≥c ƒë·ªô ti·∫øp c·∫≠n (ch√≠nh tr·ªã hay s·ª©c m·∫°nh rƒÉn ƒëe) m√† c·∫£ hai y·∫øu t·ªë ƒë·ªÅu g√≥p ph·∫ßn kh·∫≥ng ƒë·ªãnh v·ªã th·∫ø c·ªßa Li√™n X√¥.<br><br><strong>Tr√≠ch ngu·ªìn ƒë√°p √°n:</strong><br><a href='https://khoahoc.vietjack.com/question/760343/tai-sao-lien-xo-la-cho-dua-vung-chac-cua-phong-trao-cach-mang-va-hoa-b' target='_blank'>VietJack - T·∫°i sao Li√™n X√¥ l√† ch·ªó d·ª±a v·ªØng ch·∫Øc...</a><br><a href='https://loigiaihay.com/bai-tap-345775.html' target='_blank'>Loigiaihay - B√†i t·∫≠p tr·∫Øc nghi·ªám</a><br><a href='https://hoidapvietjack.com/q/923474/tai-sao-noi-lien-xo-la-cho-dua-vung-chac-cho-hoa-binh-va-cach-mang-the-gioi' target='_blank'>H·ªèi ƒë√°p VietJack</a>", o: { A: "ch√≠nh ph·ªß Li√™n X√¥ c√≥ nhi·ªÅu ch√≠nh s√°ch ƒë·ªëi ngo·∫°i h√≤a b√¨nh v√† t√≠ch c·ª±c ·ªßng h·ªô phong tr√†o gi·∫£i ph√≥ng d√¢n t·ªôc tr√™n th·∫ø gi·ªõi.", B: "Li√™n X√¥ ƒë·∫°t ƒë∆∞·ª£c th·∫ø c√¢n b·∫±ng chi·∫øn l∆∞·ª£c v·ªÅ s·ª©c m·∫°nh qu√¢n s·ª± n√≥i chung v√† s·ª©c m·∫°nh h·∫°t nh√¢n n√≥i ri√™ng so v·ªõi Mƒ©.", C: "Li√™n X√¥ l√† c∆∞·ªùng qu·ªëc c√¥ng nghi·ªáp ƒë·ª©ng h√†ng th·ª© hai tr√™n th·∫ø gi·ªõi (ch·ªâ sau Mƒ©).", D: "Li√™n X√¥ l√† n∆∞·ªõc d·∫´n ƒë·∫ßu th·∫ø gi·ªõi v·ªÅ nh·ªØng chuy·∫øn bay d√†i ng√†y trong v≈© tr·ª•." } },
            { q: "M·ªôt trong nh·ªØng nguy√™n nh√¢n gi√∫p nhi·ªÅu n∆∞·ªõc ƒê√¥ng √Çu ƒë·∫°t ƒë∆∞·ª£c nhi·ªÅu th√†nh t·ª±u kinh t·∫ø - x√£ h·ªôi giai ƒëo·∫°n 1950 - 1970 l√† nh·ªù", a: "A", o: { A: "s·ª± gi√∫p ƒë·ª° c·ªßa Li√™n X√¥.", B: "di·ªÖn ra cu·ªôc c√°ch m·∫°ng t∆∞ s·∫£n.", C: "c√≥ tr√¨nh ƒë·ªô khoa h·ªçc - kƒ© thu·∫≠t ƒëi ƒë·∫ßu.", D: "ƒë·∫•t n∆∞·ªõc h√≤a b√¨nh, kh√¥ng c√≥ s·ª± ch·ªëng ph√°." } },
            { q: "T·ª´ nƒÉm 1991, n∆∞·ªõc C·ªông h√≤a Cu-ba ƒë√£ ph·∫£i ƒë·ªëi m·∫∑t v·ªõi nhi·ªÅu kh√≥ khƒÉn th√°ch th·ª©c, ƒë·∫∑c bi·ªát l√†", a: "D", o: { A: "s·ª± ch·ªëng ph√° c·ªßa c√°c th·∫ø l·ª±c th√π ƒë·ªãch trong n∆∞·ªõc.", B: "ch√≠nh quy·ªÅn ƒë·ªôc t√†i th√¢n Mƒ© ch∆∞a b·ªã l·∫≠t ƒë·ªï.", C: "con ƒë∆∞·ªùng x√£ h·ªôi ch·ªß nghƒ©a ch∆∞a c√≥ t√≠nh ∆∞u vi·ªát.", D: "l·ªánh c·∫•m v·∫≠n k√©o d√†i c·ªßa M·ªπ v√† ph∆∞∆°ng T√¢y." } },
            
            // C√¢u 25 c√≥ h√¨nh ·∫£nh
            { q: "NƒÉm 2003, Trung Qu·ªëc ƒë·∫°t ƒë∆∞·ª£c th√†nh t·ª±u khoa h·ªçc k·ªπ thu·∫≠t n√†o sau ƒë√¢y?", a: "C", img: "https://vantanminh.github.io/lichsu-ghk1-25-26/data/2.png", o: { A: "Ph√≥ng th√†nh c√¥ng v·ªá tinh nh√¢n t·∫°o.", B: "Th·ª≠ th√†nh c√¥ng bom nguy√™n t·ª≠.", C: "Ph√≥ng t√†u v≈© tr·ª• Th·∫ßn Ch√¢u V.", D: "Ph√≥ng t√†u thƒÉm d√≤ M·∫∑t TrƒÉng." } },
            
            // C√¢u 26 c√≥ h√¨nh ·∫£nh
            { q: "M·ªôt trong nh·ªØng ƒë·∫∑c khu kinh t·∫ø ƒë·∫ßu ti√™n c·ªßa Trung Qu·ªëc ƒë∆∞·ª£c x√¢y d·ª±ng trong th·ªùi k·ª≥ c·∫£i c√°ch m·ªü c·ª≠a l√†", a: "D", img: "https://vantanminh.github.io/lichsu-ghk1-25-26/data/3.png", o: { A: "H√†ng Ch√¢u.", B: "Th√†nh ƒê√¥.", C: "Qu·∫£ng Ch√¢u.", D: "Th√¢m Quy·∫øn." } },
            
            { q: "T·ª´ cu·ªëi th·∫ø k·ª∑ XX, v·ªã th·∫ø c·ªßa Trung Qu·ªëc kh√¥ng ng·ª´ng ƒë∆∞·ª£c n√¢ng cao tr√™n tr∆∞·ªùng qu·ªëc t·∫ø l√† do", a: "A", o: { A: "s·ª± ƒëi·ªÅu ch·ªânh ch√≠nh s√°ch ƒë·ªëi ngo·∫°i v√† b√¨nh th∆∞·ªùng h√≥a quan h·ªá v·ªõi nhi·ªÅu n∆∞·ªõc.", B: "s·ªü h·ªØu nhi·ªÅu v≈© kh√≠ h·∫°t nh√¢n v√† c√¥ng ngh·ªá qu·ªëc ph√≤ng nhi·ªÅu nh·∫•t tr√™n th·∫ø gi·ªõi.", C: "ra s·ª©c th·ª±c hi·ªán ‚Äúgi·∫•c m∆° Trung Hoa‚Äù, √¢m m∆∞u l√†m b√° ch·ªß tr√™n to√†n th·∫ø gi·ªõi.", D: "th∆∞·ªùng xuy√™n g√¢y ra nhi·ªÅu cu·ªôc chi·∫øn tranh x√¢m v√† n√¥ d·ªãch c√°c n∆∞·ªõc l√°ng gi·ªÅng." } },
            { q: "NƒÉm 2010, qu·ªëc gia n√†o sau ƒë√¢y c√≥ n·ªÅn kinh t·∫ø ƒë·ª©ng th·ª© hai th·∫ø gi·ªõi?", a: "D", o: { A: "Li√™n X√¥.", B: "Nh·∫≠t B·∫£n.", C: "Vi·ªát Nam.", D: "Trung Qu·ªëc." } },
            { q: "Sau Chi·∫øn tranh th·∫ø gi·ªõi th·ª© hai, ch·ªß nghƒ©a x√£ h·ªôi t·ª´ ph·∫°m vi m·ªôt n∆∞·ªõc ƒë√£", a: "B", o: { A: "tr·ªü th√†nh si√™u c∆∞·ªùng s·ªë m·ªôt th·∫ø gi·ªõi.", B: "tr·ªü th√†nh m·ªôt h·ªá th·ªëng tr√™n th·∫ø gi·ªõi.", C: "b·ªã xo√° b·ªè ho√†n to√†n tr√™n th·∫ø gi·ªõi.", D: "lan r·ªông sang c√°c n∆∞·ªõc ·ªü T√¢y √Çu." } },
            { q: "T·ª´ nƒÉm 1978 ƒë·∫øn nay, n·ªÅn kinh t·∫ø c·ªßa Trung Qu·ªëc ƒë√£ ƒë·∫°t ƒë∆∞·ª£c th√†nh t·ª±u n·ªïi b·∫≠t l√†", a: "A", o: { A: "t·ªëc ƒë·ªô tƒÉng tr∆∞·ªüng trung b√¨nh h·∫±ng nƒÉm cao nh·∫•t th·∫ø gi·ªõi.", B: "tr·ªü th√†nh trung t√¢m kinh t·∫ø - t√†i ch√≠nh c·ªßa c·∫£ th·∫ø gi·ªõi.", C: "v∆∞·ª£t s·ª± ph√°t tri·ªÉn c·ªßa Nh·∫≠t B·∫£n, lu√¥n ƒë·ª©ng ƒë·∫ßu ch√¢u √Å.", D: "tr·ªü th√†nh qu·ªëc gia n·∫Øm gi·ªØ chu·ªói cung ·ª©ng to√†n c·∫ßu." } },
            { q: "S·ª± ki·ªán n√†o ƒë√°nh d·∫•u ch·ªß nghƒ©a x√£ h·ªôi ƒë√£ v∆∞·ª£t ra kh·ªèi ph·∫°m vi m·ªôt n∆∞·ªõc (Li√™n X√¥) v√† b∆∞·ªõc ƒë·∫ßu tr·ªü th√†nh h·ªá th·ªëng th·∫ø gi·ªõi?", a: "A", o: { A: "S·ª± ra ƒë·ªùi c√°c n∆∞·ªõc d√¢n ch·ªß nh√¢n d√¢n ƒê√¥ng √Çu.", B: "S·ª± ra ƒë·ªùi n∆∞·ªõc C·ªông h√≤a Nh√¢n d√¢n Trung Hoa.", C: "S·ª± ra ƒë·ªùi c·ªßa n∆∞·ªõc C·ªông h√≤a ·∫§n ƒê·ªô.", D: "S·ª± ra ƒë·ªùi n∆∞·ªõc C·ªông h√≤a Cuba." } },
            { q: "NƒÉm 1991, s·ª± ki·ªán n√†o d∆∞·ªõi ƒë√¢y c√≥ t√°c ƒë·ªông l·ªõn t·ªõi h·ªá th·ªëng XHCN?", a: "A", o: { A: "CNXH s·ª•p ƒë·ªï ·ªü Li√™n X√¥.", B: "CNXH b·∫Øt ƒë·∫ßu l√¢m v√†o kh·ªßng ho·∫£ng.", C: "Vi·ªát Nam ti·∫øn h√†nh ƒë∆∞·ªùng l·ªëi ƒë·ªïi m·ªõi", D: "Trung Qu·ªëc ti·∫øn h√†nh c·∫£i c√°ch." } }
        ],
        tf: [] 
    };

    document.addEventListener('DOMContentLoaded', function() {
        const quizForm = document.getElementById('quizForm');
        const mcContainer = document.getElementById('mc-questions-container');
        const tfContainer = document.getElementById('tf-questions-container');
        const part2Container = document.getElementById('part2-container');
        const submitBtn = document.querySelector('.submit-btn');
        const resultsDiv = document.getElementById('results');
        const modeRadios = document.querySelectorAll('input[name="mode"]');
        const resetBtn = document.querySelector('.reset-btn');

        let currentMode = 'practice';

        if (quizData.tf.length === 0) {
            part2Container.style.display = 'none';
        }

        // Fisher-Yates shuffle
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function createQuiz() {
            mcContainer.innerHTML = '';
            tfContainer.innerHTML = '';

            // Shuffle and create MC
            const shuffledMC = shuffle([...quizData.mc]);
            shuffledMC.forEach((qData, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-block';
                questionDiv.dataset.answer = qData.a;
                const questionName = `q${index}`;
                questionDiv.dataset.name = questionName;

                const questionHeader = document.createElement('div');
                questionHeader.className = 'question-header';
                
                // Add Question Text
                let innerContent = `<span class="q-number"></span> <span class="q-text">${qData.q}</span>`;
                questionHeader.innerHTML = innerContent;
                questionDiv.appendChild(questionHeader);

                // Add Image if exists
                if(qData.img) {
                    const imgElement = document.createElement('img');
                    imgElement.src = qData.img;
                    imgElement.className = 'question-image';
                    imgElement.alt = "H√¨nh minh h·ªça c√¢u h·ªèi";
                    questionDiv.appendChild(imgElement);
                }

                const optionsDiv = document.createElement('div');
                optionsDiv.className = 'options';

                const optionKeys = shuffle(Object.keys(qData.o));
                optionKeys.forEach(key => {
                    const label = document.createElement('label');
                    label.innerHTML = `
                        <input type="radio" name="${questionName}" value="${key}"> 
                        <span class="option-prefix"></span> 
                        <span>${qData.o[key]}</span>
                    `;
                    optionsDiv.appendChild(label);
                });

                questionDiv.appendChild(optionsDiv);

                // Add Explanation Box
                if (qData.explanation) {
                    const explainDiv = document.createElement('div');
                    explainDiv.className = 'explanation-box';
                    explainDiv.innerHTML = `<span class="explanation-title">üí° Gi·∫£i th√≠ch:</span> ${qData.explanation}`;
                    questionDiv.appendChild(explainDiv);
                }

                mcContainer.appendChild(questionDiv);
            });

            // Shuffle and create TF
            if (quizData.tf.length > 0) {
                const shuffledTF = shuffle([...quizData.tf]);
                shuffledTF.forEach((qData, qIndex) => {
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question-block tf-options';
                    
                    const questionHeader = document.createElement('div');
                    questionHeader.className = 'question-header';
                    questionHeader.innerHTML = `<span class="q-number"></span> <span class="q-text">${qData.q}</span>`;
                    questionDiv.appendChild(questionHeader);
                    
                    if(qData.img) {
                        const imgElement = document.createElement('img');
                        imgElement.src = qData.img;
                        imgElement.className = 'question-image';
                        imgElement.alt = "H√¨nh minh h·ªça c√¢u h·ªèi";
                        questionDiv.appendChild(imgElement);
                    }

                    qData.s.forEach((statement, sIndex) => {
                        const wrapper = document.createElement('div');
                        wrapper.className = 'options-wrapper';
                        const name = `q${shuffledMC.length + qIndex}_${sIndex}`;
                        wrapper.dataset.name = name;
                        wrapper.dataset.answer = statement.a;
                        
                        const statementText = `<div class="tf-statement"><span>${String.fromCharCode(97 + sIndex)})</span> ${statement.t}</div>`;
                        wrapper.innerHTML = `${statementText}
                            <div class="tf-choices">
                                <label><input type="radio" name="${name}" value="ƒê√∫ng"> ƒê√∫ng</label>
                                <label><input type="radio" name="${name}" value="Sai"> Sai</label>
                            </div>`;
                        questionDiv.appendChild(wrapper);
                    });
                    tfContainer.appendChild(questionDiv);
                });
            }

            updateNumbersAndLabels();
        }
        
        function updateNumbersAndLabels() {
            let globalQuestionIndex = 1;
            document.querySelectorAll('.question-block').forEach(qBlock => {
                qBlock.querySelector('.q-number').textContent = `C√¢u ${globalQuestionIndex++}:`;
            });
            
            document.querySelectorAll('#mc-questions-container .options').forEach(optionsDiv => {
                optionsDiv.querySelectorAll('label').forEach((label, index) => {
                    label.querySelector('.option-prefix').textContent = `${String.fromCharCode(65 + index)}.`;
                });
            });
        }
        
        function checkAnswerImmediately(event) {
            if (currentMode !== 'practice') return;
            const selectedInput = event.target;
            
            const isTF = selectedInput.closest('.tf-choices') !== null;
            
            let parentWrapper, correctAnswer, selectedLabel;

            if (isTF) {
                parentWrapper = selectedInput.closest('.options-wrapper');
                selectedLabel = selectedInput.parentElement;
            } else {
                parentWrapper = selectedInput.closest('.question-block');
                selectedLabel = selectedInput.parentElement;
            }

            correctAnswer = parentWrapper.dataset.answer;
            const userAnswer = selectedInput.value;
            const name = parentWrapper.dataset.name;
            const questionInputs = parentWrapper.querySelectorAll(`input[name="${name}"]`);
            
            // Handle multiple correct answers (e.g. "A,B")
            const correctAnswersList = correctAnswer.split(',');

            if (correctAnswersList.includes(userAnswer)) {
                selectedLabel.classList.add('immediate-correct');
            } else {
                selectedLabel.classList.add('immediate-incorrect');
            }
            
            // Show explanation if exists
            const explanation = parentWrapper.querySelector('.explanation-box');
            if (explanation) explanation.classList.add('show');
            
            if (isTF) {
                 parentWrapper.querySelectorAll('input').forEach(input => {
                    if(correctAnswersList.includes(input.value)) {
                        input.parentElement.classList.add('show-correct-answer');
                    }
                    input.disabled = true;
                });
            } else {
                parentWrapper.querySelectorAll('.options input').forEach(input => {
                    if(correctAnswersList.includes(input.value)) {
                        input.parentElement.classList.add('show-correct-answer');
                    }
                    input.disabled = true;
                });
            }
        }

        function setupListenersForMode() {
            if (currentMode === 'practice') {
                submitBtn.classList.add('hidden');
                document.querySelectorAll('input[type="radio"]:not([name="mode"])').forEach(input => {
                    input.addEventListener('change', checkAnswerImmediately);
                });
            } else {
                submitBtn.classList.remove('hidden');
                document.querySelectorAll('input[type="radio"]:not([name="mode"])').forEach(input => {
                    input.removeEventListener('change', checkAnswerImmediately);
                    input.disabled = false;
                });
            }
        }
        
        function initializeQuiz() {
            quizForm.reset();
            resultsDiv.classList.add('hidden');
            createQuiz();
            setupListenersForMode();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        modeRadios.forEach(radio => {
            radio.addEventListener('change', (event) => {
                currentMode = event.target.value;
                initializeQuiz();
            });
        });
        
        resetBtn.addEventListener('click', initializeQuiz);

        quizForm.addEventListener('submit', function(event) {
            event.preventDefault();
            if (currentMode !== 'test') return;

            let scoreMC = 0;
            let totalMC = quizData.mc.length;
            let scoreTF = 0;
            let totalTF = quizData.tf.reduce((acc, curr) => acc + curr.s.length, 0);

            document.querySelectorAll('#mc-questions-container .question-block').forEach(q => {
                const correctAnswer = q.dataset.answer;
                const userInput = q.querySelector('input:checked');
                
                q.querySelectorAll('input').forEach(i => i.disabled = true);

                const correctAnswersList = correctAnswer.split(',');
                
                // Show explanation
                const explanation = q.querySelector('.explanation-box');
                if (explanation) explanation.classList.add('show');

                if (userInput) {
                    const userLabel = userInput.parentElement;
                    if (correctAnswersList.includes(userInput.value)) {
                        scoreMC++;
                        userLabel.classList.add('final-correct');
                    } else {
                        userLabel.classList.add('final-incorrect');
                         correctAnswersList.forEach(val => {
                            const correctInput = q.querySelector(`input[value="${val}"]`);
                            if(correctInput) correctInput.parentElement.classList.add('final-correct');
                         });
                    }
                } else {
                     correctAnswersList.forEach(val => {
                        const correctInput = q.querySelector(`input[value="${val}"]`);
                        if(correctInput) correctInput.parentElement.classList.add('show-correct-answer');
                     });
                }
            });

            document.querySelectorAll('#tf-questions-container .options-wrapper').forEach(item => {
                const correctAnswer = item.dataset.answer;
                const userInput = item.querySelector('input:checked');
                
                 item.querySelectorAll('input').forEach(i => i.disabled = true);

                if (userInput) {
                    if (userInput.value === correctAnswer) {
                        scoreTF++;
                        userInput.parentElement.classList.add('final-correct');
                    } else {
                        userInput.parentElement.classList.add('final-incorrect');
                        item.querySelector(`input[value="${correctAnswer}"]`).parentElement.classList.add('final-correct');
                    }
                }
            });

            document.getElementById('score-mc').innerHTML = `üîπ Ph·∫ßn I (Tr·∫Øc nghi·ªám): <strong>${scoreMC} / ${totalMC}</strong> c√¢u.`;
            
            const tfResult = document.getElementById('score-tf');
            if(totalTF > 0) {
                tfResult.innerHTML = `üî∏ Ph·∫ßn II (ƒê√∫ng - Sai): <strong>${scoreTF} / ${totalTF}</strong> √Ω.`;
                tfResult.classList.remove('hidden');
                document.getElementById('total-score').textContent = `T·ªïng ƒëi·ªÉm: ${scoreMC + scoreTF} / ${totalMC + totalTF}`;
            } else {
                 tfResult.classList.add('hidden');
                 document.getElementById('total-score').textContent = `ƒêi·ªÉm s·ªë: ${scoreMC} / ${totalMC}`;
            }

            resultsDiv.classList.remove('hidden');
            setTimeout(() => {
                resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 100);
        });

        initializeQuiz();
    });
    </script>

</body>
</html>
